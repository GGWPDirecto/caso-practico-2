---
# Tareas para el rol de ACR
- name: Login en ACR
  community.docker.docker_login:
    registry_url: "{{ acr_login_server }}"
    username: "{{ acr_username }}"
    password: "{{ acr_password }}"
  delegate_to: localhost

- name: Descargar imagen desde DockerHub
  community.docker.docker_image:
    name: "{{ dockerhub_image }}"
    source: pull
    force_source: true
  delegate_to: localhost

- name: Etiquetar imagen para ACR (v1)
  community.docker.docker_image:
    name: "{{ dockerhub_image }}"
    tag: v1
    repository: "{{ acr_login_server }}/{{ acr_image_name }}"
    source: local
    push: false
    force_tag: true
  delegate_to: localhost

- name: Subir imagen a ACR (v1)
  community.docker.docker_image:
    name: "{{ acr_login_server }}/{{ acr_image_name }}"
    tag: v1
    source: local
    push: true
  delegate_to: localhost
