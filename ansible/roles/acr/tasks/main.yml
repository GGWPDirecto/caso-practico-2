---
# Tareas para el rol de ACR
- name: Login en ACR
  community.docker.docker_login:
    registry_url: "{{ acr_login_server }}"
    username: "{{ acr_username }}"
    password: "{{ acr_password }}"

- name: Descargar imagen desde DockerHub
  community.docker.docker_image:
    name: "{{ dockerhub_image }}"
    source: pull

- name: Etiquetar imagen para ACR
  community.docker.docker_image:
    name: "{{ dockerhub_image }}"
    tag: "{{ acr_image_tag }}"
    repository: "{{ acr_login_server }}/{{ acr_image_name }}"
    source: local
    push: false

- name: Subir imagen a ACR
  community.docker.docker_image:
    name: "{{ acr_login_server }}/{{ acr_image_name }}"
    tag: "{{ acr_image_tag }}"
    push: true
